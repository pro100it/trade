#images|styles|scripts|uploads|_manager|_website|_cache|
RewriteRule ^(images|styles|scripts|flash|files|files_pre|_plugins|.*\.(doc|docx|xls|xlsx|css|js|jpg|mp3|jpeg|gif|swf|xml|png|pdf|ico|zip|rar|php|html|txt|sql|woff|eot|ttf|svg|csv)) - [L]

RewriteCond %{REQUEST_FILENAME} !-f [OR] 
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule . open.php [QSA,L]

# choose opener file
DirectoryIndex open.php 

# block access to some sensible files
<Files ~ "^sftp-config.json|.git|.htaccess|config.php|functions|backup|controller|model|view|_plugins|_temporaty">
  Order allow,deny
  Deny from all
</Files>

<IfModule php5_module>
    php_flag session.cookie_httponly on
</IfModule>

# force non-www domain
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
<Files 403.shtml>
order allow,deny
allow from all
</Files>

deny from 89.38.144.160
deny from 188.143.232.37
deny from 188.129.129.222
deny from 188.143.232.11
deny from 119.157.148.123
deny from 93.80.116.134
deny from 78.139.137.159
deny from 196.44.98.54
deny from 37.146.69.247
deny from 190.98.162.22
deny from 94.76.179.1
deny from 209.249.157.69
deny from 5.135.5.113
deny from 95.24.235.148
deny from 187.44.1.54
deny from 181.168.99.14
deny from 195.154.191.67
deny from 186.225.99.155
deny from 176.10.107.180